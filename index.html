<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Autodance Share Online</title>
<style>
/* Fonte Tungsten Bold */
@font-face {
    font-family: 'TungstenBold';
    src: url('Tungsten-Bold.ttf') format('truetype');
}
body {
    font-family: Arial, sans-serif;
    background: url('IMG_2223.jpeg') no-repeat center center fixed;
    background-size: cover;
    color:#f0f0f0;
    margin:0;
    padding:0;
}
header {
    font-family: 'TungstenBold', Arial, sans-serif;
    font-weight: normal;
    background: rgba(255,77,77,0.3);
    padding: 1.2em;
    text-align: center;
    font-size: 2.2em;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    border-radius: 0 0 12px 12px;
}
main {
    max-width: 900px;
    margin: 2em auto;
    padding: 2em;
    background: rgba(0,0,0,0.3);
    backdrop-filter: blur(10px);
    border-radius: 16px;
}
h2 {
    margin-top:1.5em;
    color:#ffbb33;
}
input, button {
    font-size:1em;
    border-radius:12px;
    border:none;
    padding:0.8em;
    margin-bottom:0.5em;
}
input[type="text"], input[type="url"], input[type="email"], input[type="password"] {
    width:100%;
    background: rgba(255,255,255,0.1);
    color:#fff;
    border: 1px solid rgba(255,255,255,0.2);
    backdrop-filter: blur(6px);
    transition: border 0.3s, background 0.3s;
}
input::placeholder {
    color:#ccc;
}
input:focus {
    border:1px solid #ffbb33;
    background: rgba(255,255,255,0.2);
    outline:none;
}
button {
    background: linear-gradient(135deg, #ff4d4d, #ffbb33);
    color: #fff;
    font-weight: bold;
    cursor:pointer;
    transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
    padding:0.8em 1.5em;
}
button:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 20px rgba(255,187,51,0.6);
    background: linear-gradient(135deg, #ffbb33, #ff4d4d);
}
.post {
    background: rgba(30,30,30,0.4);
    backdrop-filter: blur(8px);
    padding:1em;
    border-radius:12px;
    margin-bottom:1em;
    box-shadow: 0 8px 20px rgba(0,0,0,0.5);
    transition: transform 0.2s, box-shadow 0.2s;
    position: relative;
}
.post:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 28px rgba(0,0,0,0.6);
}
.author {
    font-weight:bold;
    color:#ffbb33;
    margin-bottom:0.5em;
}
.video-container {
    position:relative;
    width:100%;
    height:0;
    padding-bottom:56.25%;
    margin-top:0.5em;
}
.video-container iframe {
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    border:none;
    border-radius:8px;
}
.delete-btn {
    margin-top:0.5em;
    background:#ff5555;
    color:#fff;
    border:none;
    padding:0.5em 1em;
    border-radius:8px;
    cursor:pointer;
    transition: background 0.3s, transform 0.2s;
}
.delete-btn:hover {
    background:#e04343;
    transform: scale(1.05);
}
.post.own {
    border: 2px solid #ffbb33;
}
.tag-box {
    font-family: 'TungstenBold', Arial, sans-serif;
    display: inline-block;
    background: rgba(255,187,51,0.2);
    color: #ffbb33;
    padding: 4px 10px;
    margin: 3px 3px 0 0;
    border-radius: 8px;
    font-size: 0.85em;
}
#searchInput {
    width:100%;
    padding:0.8em;
    margin-bottom:1em;
    border-radius:12px;
    border:1px solid rgba(255,255,255,0.2);
    background: rgba(255,255,255,0.1);
    color:#fff;
}
#searchInput:focus {
    outline:none;
    border:1px solid #ffbb33;
}

/* CARROSSEL DE AVATAR ESTILO JD2014 */
#avatar-selection {
    position: fixed;
    top:0; left:0;
    width:100%;
    height:100%;
    background: rgba(0,0,0,0.95);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    z-index:1000;
    color:#ffbb33;
}
.avatar-carousel {
    display:flex;
    align-items:center;
    margin-top:2em;
}
.avatars-container {
    display:flex;
    overflow:hidden;
    width:600px;
    perspective:1000px;
}
.avatar-container {
    flex:0 0 auto;
    width:100px;
    height:100px;
    margin:0 5px;
    border-radius:12px;
    transition: transform 0.4s, opacity 0.4s;
    cursor:pointer;
}
.avatar-container img {
    width:100%;
    height:100%;
    border-radius:12px;
    object-fit:cover;
    display:block;
}
.avatar-container.center {
    transform: scale(1.6) translateY(-10px);
    z-index:2;
    opacity:1;
}
.avatar-container.side {
    transform: scale(1) translateY(0);
    z-index:1;
    opacity:0.6;
}
.confirm-btn {
    margin-top:1.5em; padding:0.8em 1.5em; font-weight:bold;
}
</style>
</head>
<body>

<!-- TELA DE AVATAR -->
<div id="avatar-selection">
    <h2>Escolha seu Avatar</h2>
    <div class="avatar-carousel">
        <button id="prev-avatar">&#8592;</button>
        <div class="avatars-container" id="avatars-container"></div>
        <button id="next-avatar">&#8594;</button>
    </div>
    <button id="confirm-avatar" class="confirm-btn">Confirmar</button>
</div>

<!-- TELA PRINCIPAL -->
<main id="main-site" style="display:none;">
<header>Autodance Share Online</header>

<h2>Login / Registro</h2>
<input type="email" id="email" placeholder="Email">
<input type="password" id="senha" placeholder="Senha">
<button id="loginBtn">Login / Criar conta</button>

<h2>Poste sua autodance</h2>
<input type="text" id="author" placeholder="Seu nome" disabled>
<input type="url" id="videoUrl" placeholder="Cole o embed do Streamable (src)" disabled>
<input type="text" id="tags" placeholder="Tags (ex: Just Dance 2015, Solo, Funk)" disabled>
<button id="postBtn" disabled>Postar</button>

<h2>Pesquisar por tag</h2>
<input type="text" id="searchInput" placeholder="Pesquisar tag...">

<h2>Autodances enviadas</h2>
<div id="posts"></div>
</main>

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
import { getDatabase, ref, onValue, set, push, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCA2XWZzavTNdHi_w8X5aASfBTfoLVsghY",
  authDomain: "auto-dance.firebaseapp.com",
  databaseURL: "https://auto-dance-default-rtdb.firebaseio.com",
  projectId: "auto-dance",
  storageBucket: "auto-dance.firebasestorage.app",
  messagingSenderId: "960760470726",
  appId: "1:960760470726:web:f5af55d01df6a2be0d4bc7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

const emailInput = document.getElementById("email");
const senhaInput = document.getElementById("senha");
const loginBtn = document.getElementById("loginBtn");
const authorInput = document.getElementById("author");
const videoInput = document.getElementById("videoUrl");
const tagsInput = document.getElementById("tags");
const postBtn = document.getElementById("postBtn");
const postsContainer = document.getElementById("posts");
const searchInput = document.getElementById("searchInput");

let currentUser = null;
const blockedWords = ["puta","merda","caralho","bosta","porra","foda","fodase","fuck","shit","bitch","asshole","damn","dick","piss","crap","cunt","coño","gilipollas","joder","cabron","merde","putain","con","connard","salope","bordel","nigger","nigga","slut","whore","fag","retard"];

// Login / criar conta
loginBtn.addEventListener("click", async ()=>{
    const email = emailInput.value.trim();
    const senha = senhaInput.value.trim();
    if(!email||!senha){alert("Preencha email e senha!"); return;}
    try{ await signInWithEmailAndPassword(auth,email,senha); }
    catch(e){ 
        try{ await createUserWithEmailAndPassword(auth,email,senha); }
        catch(err){ alert(err.message); return; }
    }
});

// Detecta login
onAuthStateChanged(auth,user=>{
    if(user){
        currentUser=user;
        authorInput.value = user.email.split("@")[0];
        authorInput.disabled=false;
        videoInput.disabled=false;
        tagsInput.disabled=false;
        postBtn.disabled=false;
        loginBtn.disabled=true;
        emailInput.disabled=true;
        senhaInput.disabled=true;
        loadPosts();
    } else {
        currentUser=null;
        authorInput.disabled=true;
        videoInput.disabled=true;
        tagsInput.disabled=true;
        postBtn.disabled=true;
        loginBtn.disabled=false;
        emailInput.disabled=false;
        senhaInput.disabled=false;
        postsContainer.innerHTML="";
    }
});

// Adiciona post
postBtn.addEventListener("click", async ()=>{
    const author = authorInput.value;
    const video = videoInput.value.trim();
    let tags = tagsInput.value.trim().split(",").map(t=>t.trim()).filter(t=>t);
    if(!video.includes("streamable.com")){ alert("Só é permitido Streamable!"); return;}
    if(tags.some(t=>blockedWords.some(w=>t.toLowerCase().includes(w)))){ alert("Tags impróprias não são permitidas!"); return;}
    const postRef = push(ref(db,"posts"));
    await set(postRef,{author,video,tags,uid:currentUser.uid});
    videoInput.value=""; tagsInput.value="";
});

// Carrega posts
function loadPosts(){
    onValue(ref(db,"posts"),snapshot=>{
        postsContainer.innerHTML="";
        const data = snapshot.val();
        if(!data) return;
        Object.entries(data).reverse().forEach(([key,post])=>{
            const div = document.createElement("div");
            div.className="post";
            if(post.uid===currentUser.uid) div.classList.add("own");
            div.innerHTML=`
                <div class="author">${post.author}:</div>
                <div class="video-container">
                    <iframe src="${post.video}" allowfullscreen></iframe>
                </div>
            `;
            if(post.tags&&post.tags.length){
                const tagsContainer=document.createElement("div");
                tagsContainer.style.marginTop="0.5em";
                post.tags.forEach(tag=>{
                    const tagBox=document.createElement("span");
                    tagBox.className="tag-box";
                    tagBox.textContent=tag;
                    tagsContainer.appendChild(tagBox);
                });
                div.appendChild(tagsContainer);
            }
            if(post.uid===currentUser.uid){
                const delBtn=document.createElement("button");
                delBtn.textContent="Excluir";
                delBtn.className="delete-btn";
                delBtn.onclick=()=>remove(ref(db,"posts/"+key));
                div.appendChild(delBtn);
            }
            postsContainer.appendChild(div);
        });
    });
}

// Filtrar pesquisa
searchInput.addEventListener("input", ()=>{
    const filter = searchInput.value.trim().toLowerCase();
    const posts = postsContainer.querySelectorAll(".post");
    posts.forEach(p=>{
        const tags = Array.from(p.querySelectorAll(".tag-box")).map(t=>t.textContent.toLowerCase());
        p.style.display = tags.some(t=>t.includes(filter)) ? "" : "none";
    });
});

// --- CARROSSEL AVATAR ---
const avatarFiles = [
"All I Want for Christmas Is You.png","American Girl.png","Applause (Stage).png","Applause.png","Aquarius Let The Sunshine In (P1).png",
"Aquarius Let The Sunshine In (P2).png","Blame It on the Boogie (P3).png","Blurred Lines (Extreme).png","Blurred Lines (P1).png",
"Blurred Lines (P2).png","Candy (P2).png","Can’t Get Enough.png","Can’t Hold Us.png","Careless Whisper (P1).png","Could You Be Loved (P1).png",
"C’mon (P1).png","C’mon (P2).png","Dançando (Fankit Avatar).png","Dançando.png","Danse (Pop Version).png","Don’t You Worry Child.png",
"Feel So Right.png","Feel This Moment.png","Fine China (Extreme).png","Fine China.png","Flashdance... What a Feeling.png","Follow the Leader.png",
"Gentleman (C1).png","Gentleman (C2).png","Gentleman (Sweat).png","Get Lucky (P1).png","Get Lucky (P2).png","Ghostbusters (P1).png",
"Ghostbusters (P2).png","Ghostbusters (P3).png","Ghostbusters (P4).png","Ghostbusters (Sweat).png","Gimme! Gimme! Gimme! (A Man After Midnight) (On-Stage).png",
"Gimme! Gimme! Gimme! (A Man After Midnight).png","I Kissed a Girl (Sing Along).png","I Kissed a Girl (Sweat).png","I Kissed a Girl.png",
"I Need Your Love.png","I Will Survive (On-Stage).png","I Will Survive.png","In the Summertime.png","Isidora.png","It’s You (Sweat).png",
"It’s You.png","Just A Gigolo (P1).png","Just A Gigolo (P2).png","Just Dance (C1).png","Just Dance (C2).png","Just Dance (Sing Along).png",
"Just Dance (Sweat).png","Kiss You (6-Player) (P1).png","Kiss You (P2).png","Kiss You (P3).png","Limbo (P1).png","Limbo (P2).png","Love Boat.png",
"María.png","Miss Understood.png","Moskau (P1).png","My Main Girl.png","Nitro Bot (P1).png","Nitro Bot (P2).png","One Way Or Another (Teenage Kicks).png",
"Pound The Alarm (Extreme).png","Pound The Alarm (P3).png","Prince Ali (P4).png","Rich Girl.png","Roar.png","Rock n Roll.png","Safe And Sound (C1).png",
"Sexy And I Know It.png","She Wolf (Falling to Pieces).png","Starships (Charleston) (P1).png","Starships.png","The Other Side.png",
"The Way (P2).png","The World is Ours.png","Timber (P1).png","Timber (P2).png","Troublemaker.png","Turn Up The Love (P1).png",
"Turn Up The Love (Sumo) (P3).png","Wake Me Up (C1).png","Wake Me Up (C2).png","Waking Up in Vegas.png","We Can’t Stop.png","What About Love.png",
"Where Have You Been.png","Wild.png","Y.M.C.A. (P1).png","Y.M.C.A. (P2).png","Y.M.C.A. (P3).png","Y.M.C.A. (P4).png"
];

const avatarsContainer = document.getElementById("avatars-container");
let centerIndex = 0;

// Cria elementos dos avatares
avatarFiles.forEach((file,i)=>{
    const div = document.createElement("div");
    div.className="avatar-container";
    const img = document.createElement("img");
    img.src = `/Just dance avatars/${file}`;
    div.appendChild(img);
    div.addEventListener("click", ()=>{
        centerIndex = i;
        updateCarousel();
    });
    avatarsContainer.appendChild(div);
});

// Atualiza visual do carrossel
function updateCarousel(){
    const children = avatarsContainer.children;
    for(let i=0;i<children.length;i++){
        const diff = i - centerIndex;
        if(diff===0){
            children[i].className="avatar-container center";
        } else if(diff===-1 || diff===1){
            children[i].className="avatar-container side";
        } else {
            children[i].className="avatar-container";
            children[i].style.opacity=0.3;
        }
    }
    const scrollPos = (centerIndex - 1) * 110;
    avatarsContainer.scrollTo({left:scrollPos, behavior:"smooth"});
}

// Botões de navegação
document.getElementById("prev-avatar").addEventListener("click", ()=>{
    if(centerIndex>0){ centerIndex--; updateCarousel(); }
});
document.getElementById("next-avatar").addEventListener("click", ()=>{
    if(centerIndex<avatarFiles.length-1){ centerIndex++; updateCarousel(); }
});

// Confirmar avatar
document.getElementById("confirm-avatar").addEventListener("click", ()=>{
    localStorage.setItem("selectedAvatar", `/Just dance avatars/${avatarFiles[centerIndex]}`);
    document.getElementById("avatar-selection").style.display="none";
    document.getElementById("main-site").style.display="block";
});

// Inicializa
updateCarousel();
</script>
</body>
</html>